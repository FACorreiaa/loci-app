package hotels

templ HotelsPage() {
	<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8">
			<!-- Header -->
			<div class="text-center mb-8">
				<h1 class="text-3xl lg:text-4xl font-bold text-foreground mb-4">
					Hotels & Accommodations
				</h1>
				<p class="text-lg text-muted-foreground max-w-3xl mx-auto">
					Find the perfect place to stay from luxury hotels to boutique accommodations
				</p>
			</div>
			<!-- Search and Booking Section -->
			<div class="bg-card rounded-xl shadow-sm border p-6 mb-8">
				<div class="grid grid-cols-1 lg:grid-cols-5 gap-4">
					<div class="lg:col-span-2">
						<label class="block text-sm font-medium mb-2">Location</label>
						<div class="relative">
							<input
								type="text"
								placeholder="Enter destination"
								value="Lisbon, Portugal"
								class="w-full pl-10 pr-4 py-3 border border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
							/>
							<svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
							</svg>
						</div>
					</div>
					<div>
						<label class="block text-sm font-medium mb-2">Check-in</label>
						<input
							type="date"
							class="w-full p-3 border border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
						/>
					</div>
					<div>
						<label class="block text-sm font-medium mb-2">Check-out</label>
						<input
							type="date"
							class="w-full p-3 border border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
						/>
					</div>
					<div class="flex gap-2">
						<div class="flex-1">
							<label class="block text-sm font-medium mb-2">Guests</label>
							<select class="w-full p-3 border border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
								<option>1 Guest</option>
								<option>2 Guests</option>
								<option>3 Guests</option>
								<option>4+ Guests</option>
							</select>
						</div>
					</div>
				</div>
				<div class="mt-4 flex flex-wrap gap-3">
					<button
						class="px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
						hx-post="/hotels/search"
						hx-include="closest form"
						hx-target="#hotels-results"
					>
						Search Hotels
					</button>
					<div class="flex flex-wrap gap-2" x-data="{ showFilters: false }">
						<button
							@click="showFilters = !showFilters"
							class="flex items-center gap-2 px-4 py-2 border border-input rounded-lg hover:bg-accent transition-colors"
						>
							<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"></path>
							</svg>
							Filters
						</button>
						<!-- Filter Panel -->
						<div x-show="showFilters" x-transition class="absolute top-full left-0 right-0 mt-2 bg-card border rounded-lg shadow-lg p-4 z-10">
							<div class="grid grid-cols-1 md:grid-cols-4 gap-4">
								<div>
									<label class="block text-sm font-medium mb-2">Hotel Type</label>
									<select name="type" class="w-full p-2 border border-input rounded">
										<option value="">All Types</option>
										<option value="luxury">Luxury Hotel</option>
										<option value="boutique">Boutique Hotel</option>
										<option value="business">Business Hotel</option>
										<option value="historic">Historic Hotel</option>
									</select>
								</div>
								<div>
									<label class="block text-sm font-medium mb-2">Price Range</label>
									<select name="price" class="w-full p-2 border border-input rounded">
										<option value="">Any Price</option>
										<option value="budget">€ (Budget)</option>
										<option value="mid">€€ (Moderate)</option>
										<option value="upscale">€€€ (Upscale)</option>
										<option value="luxury">€€€€ (Luxury)</option>
									</select>
								</div>
								<div>
									<label class="block text-sm font-medium mb-2">Rating</label>
									<select name="rating" class="w-full p-2 border border-input rounded">
										<option value="">Any Rating</option>
										<option value="5">5 Stars</option>
										<option value="4">4+ Stars</option>
										<option value="3">3+ Stars</option>
									</select>
								</div>
								<div>
									<label class="block text-sm font-medium mb-2">Amenities</label>
									<div class="space-y-1">
										<label class="flex items-center text-sm">
											<input type="checkbox" class="mr-2"/>
											Pool
										</label>
										<label class="flex items-center text-sm">
											<input type="checkbox" class="mr-2"/>
											Spa
										</label>
										<label class="flex items-center text-sm">
											<input type="checkbox" class="mr-2"/>
											Restaurant
										</label>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Hotels Results -->
			<div id="hotels-results">
				<!-- Results will be loaded here via HTMX based on user query/preferences -->
				<div class="text-center py-8">
					<div class="animate-pulse">
						<div class="w-12 h-12 bg-indigo-400 rounded-full mx-auto mb-4"></div>
						<p class="text-muted-foreground">Loading personalized hotel recommendations...</p>
					</div>
				</div>
			</div>
			<!-- Load More Button -->
			<div class="text-center mt-8">
				<button
					class="px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
					hx-get="/hotels/load-more"
					hx-target="#hotels-results"
					hx-swap="beforeend"
				>
					Load More Hotels
				</button>
			</div>
		</div>
	</div>
	<script>
		// Auto-load results based on query parameter or user intent
		document.addEventListener('DOMContentLoaded', function() {
			const urlParams = new URLSearchParams(window.location.search);
			const query = urlParams.get('q');
			const city = urlParams.get('city');
			const intent = urlParams.get('intent');
			
			if (query || city) {
				// Show loading state and load results
				loadHotelResults({
					query: query || '',
					city: city || '',
					intent: intent || 'accommodation'
				});
			}
		});
		
		function loadHotelResults(params) {
			htmx.ajax('POST', '/hotels/search', {
				source: {
					query: params.query,
					city: params.city,
					intent: params.intent,
					domain: 'accommodation'
				},
				target: '#hotels-results',
				swap: 'innerHTML'
			});
		}
		
		// Update UI state after results load
		document.body.addEventListener('htmx:afterSwap', function(evt) {
			if (evt.detail.target.id === 'hotels-results') {
				console.log('Hotels results loaded');
			}
		});
	</script>
}

templ HotelsGrid() {
	<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
		@HotelCard("Pestana Palace Lisboa", "Luxury Hotel", "Historic palace hotel with stunning gardens and luxury amenities", "4.8", "€€€€", "Spa, Pool, Restaurant")
		@HotelCard("The Lumiares Hotel & Spa", "Luxury Hotel", "Modern luxury in historic Lisbon with world-class spa facilities", "4.7", "€€€€", "Spa, Pool, Bar")
		@HotelCard("Memmo Alfama Hotel", "Boutique Hotel", "Contemporary design hotel with panoramic views of the Tagus River", "4.6", "€€€", "Rooftop Bar, Restaurant")
		@HotelCard("Hotel Dom Henrique", "Business Hotel", "Central location with modern amenities perfect for business travelers", "4.4", "€€", "Business Center, Gym")
		@HotelCard("Palácio Belmonte", "Historic Hotel", "Exclusive historic palace with unique rooms and unparalleled luxury", "4.9", "€€€€", "Historic, Pool, Garden")
		@HotelCard("Browns Central Hotel", "Boutique Hotel", "Stylish boutique hotel in the heart of Lisbon's downtown", "4.5", "€€€", "Restaurant, Bar, Concierge")
	</div>
}

templ HotelCard(name, category, description, rating, price, amenities string) {
	<article class="group bg-card rounded-xl shadow-sm border hover:shadow-md transition-all duration-300">
		<div class="aspect-video bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900 dark:to-indigo-900 rounded-t-xl relative overflow-hidden">
			<div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors"></div>
			<div class="absolute top-3 left-3">
				<span class="px-3 py-1 bg-white/90 dark:bg-black/90 text-sm font-medium rounded-full">
					{ category }
				</span>
			</div>
			<div class="absolute top-3 right-3 flex gap-2">
				<button class="p-2 bg-white/90 dark:bg-black/90 rounded-full hover:bg-white dark:hover:bg-black transition-colors">
					<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
					</svg>
				</button>
				<button class="p-2 bg-white/90 dark:bg-black/90 rounded-full hover:bg-white dark:hover:bg-black transition-colors">
					<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
					</svg>
				</button>
			</div>
		</div>
		<div class="p-6">
			<div class="flex items-start justify-between mb-3">
				<h3 class="text-lg font-semibold text-foreground group-hover:text-primary transition-colors">
					{ name }
				</h3>
				<div class="flex items-center gap-1 text-sm">
					<svg class="w-4 h-4 text-yellow-500 fill-current" viewBox="0 0 20 20">
						<path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
					</svg>
					<span class="font-medium">{ rating }</span>
				</div>
			</div>
			<p class="text-muted-foreground text-sm mb-4 line-clamp-2">
				{ description }
			</p>
			<div class="flex items-center gap-2 mb-4">
				<div class="flex flex-wrap gap-1">
					<span class="px-2 py-1 bg-accent text-accent-foreground text-xs rounded-full">
						Pool
					</span>
					<span class="px-2 py-1 bg-accent text-accent-foreground text-xs rounded-full">
						Spa
					</span>
					<span class="px-2 py-1 bg-accent text-accent-foreground text-xs rounded-full">
						Restaurant
					</span>
				</div>
			</div>
			<div class="flex items-center justify-between">
				<div class="flex flex-col gap-1">
					<div class="flex items-center gap-2 text-sm font-medium">
						{ price }
						<span class="text-muted-foreground font-normal">per night</span>
					</div>
					<div class="text-xs text-muted-foreground">
						Free cancellation
					</div>
				</div>
				<div class="flex gap-2">
					<button class="px-3 py-2 border border-input rounded-lg hover:bg-accent transition-colors text-sm">
						Compare
					</button>
					<button
						class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors text-sm"
						hx-get={ "/hotels/" + name }
						hx-target="#modal-content"
						hx-trigger="click"
					>
						Book Now
					</button>
				</div>
			</div>
		</div>
	</article>
}

// HotelsPageWithQuery renders the hotels page with a query parameter for LLM streaming
templ HotelsPageWithQuery(query string) {
	<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8">
			<!-- Header -->
			<div class="text-center mb-8">
				<h1 class="text-3xl lg:text-4xl font-bold text-foreground mb-4">
					Hotel Recommendations
				</h1>
				<p class="text-lg text-muted-foreground max-w-3xl mx-auto">
					AI-powered accommodation suggestions for: <span class="font-semibold">{ query }</span>
				</p>
			</div>
			
			<!-- Loading/Streaming Banner -->
			<div class="mb-6">
				<div class="bg-gradient-to-r from-purple-50 to-blue-50 dark:from-gray-800 dark:to-gray-700 rounded-xl p-6 border">
					<div class="flex items-center gap-4">
						<div class="text-4xl">🏨</div>
						<div class="flex-1">
							<h3 class="font-semibold text-card-foreground mb-1">Finding Perfect Hotels</h3>
							<p class="text-sm text-muted-foreground">Analyzing your request: { query }</p>
							<div class="mt-3">
								<div class="flex items-center gap-2 text-purple-600">
									<div class="w-4 h-4 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"></div>
									<span class="text-sm font-medium">Loading personalized hotel recommendations...</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			<!-- Results Container - This will be populated by HTMX -->
			<div id="hotel-results" class="space-y-6"
				hx-post="/hotels/search" 
				hx-trigger="load"
				hx-vals={ "{\"query\":\"" + query + "\", \"city\":\"\"}" }
				hx-swap="innerHTML">
				<!-- Results will be loaded here -->
				<div class="text-center py-8">
					<div class="w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto"></div>
					<p class="mt-4 text-muted-foreground">Searching for hotels...</p>
				</div>
			</div>
		</div>
	</div>
}
